
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>番茄钟</title>
    <style>
        /* 基础重置和变量定义 */
        :root {
            /* 糖果色主题 */
            --candy-primary: #ff9a9e;
            --candy-secondary: #fad0c4;
            --candy-accent: #a1c4fd;
            --candy-bg: #ffffff;
            --candy-text: #333333;
            --candy-border: #e0e0e0;
            --candy-button: #ff9a9e;
            --candy-button-hover: #ff758c;
            --candy-progress: #a1c4fd;
            
            /* 薄荷色主题 */
            --mint-primary: #a8ff78;
            --mint-secondary: #78ffd6;
            --mint-accent: #52c234;
            --mint-bg: #f0fff0;
            --mint-text: #2d5a3d;
            --mint-border: #c2e9d8;
            --mint-button: #52c234;
            --mint-button-hover: #3a9e22;
            --mint-progress: #78ffd6;
            
            /* 樱花色主题 */
            --sakura-primary: #ff9a9e;
            --sakura-secondary: #fad0c4;
            --sakura-accent: #fbc2eb;
            --sakura-bg: #fff5f5;
            --sakura-text: #6a4c4f;
            --sakura-border: #f8c6d0;
            --sakura-button: #ff9a9e;
            --sakura-button-hover: #ff758c;
            --sakura-progress: #fbc2eb;
            
            /* 深色主题 */
            --dark-primary: #8e44ad;
            --dark-secondary: #34495e;
            --dark-accent: #3498db;
            --dark-bg: #1a1a2e;
            --dark-text: #f0f0f0;
            --dark-border: #2d2d44;
            --dark-button: #8e44ad;
            --dark-button-hover: #9b59b6;
            --dark-progress: #3498db;
            
            /* 当前主题 */
            --primary: var(--candy-primary);
            --secondary: var(--candy-secondary);
            --accent: var(--candy-accent);
            --bg: var(--candy-bg);
            --text: var(--candy-text);
            --border: var(--candy-border);
            --button: var(--candy-button);
            --button-hover: var(--candy-button-hover);
            --progress: var(--candy-progress);
            
            /* 像素字体 */
            --pixel-font: 'Press Start 2P', 'Courier New', monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--pixel-font);
            background-color: var(--bg);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        /* 标题区域 */
        .header {
            width: 100%;
            max-width: 600px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
        }

        h1 {
            font-size: 24px;
            text-align: center;
            color: var(--primary);
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .theme-selector {
            display: flex;
            gap: 10px;
        }

        .theme-btn {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .theme-btn:hover {
            transform: scale(1.1);
        }

        .theme-btn.candy { background-color: var(--candy-primary); }
        .theme-btn.mint { background-color: var(--mint-primary); }
        .theme-btn.sakura { background-color: var(--sakura-primary); }
        .theme-btn.dark { background-color: var(--dark-primary); }

        /* 主计时器区域 */
        .timer-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 20px 0;
        }

        .timer-display {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2;
        }

        .phase-label {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--accent);
            text-shadow: 1px 1px 0px rgba(0,0,0,0.1);
        }

        .time-display {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--primary);
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .progress-ring {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            stroke: var(--progress);
            stroke-width: 8;
            stroke-linecap: round;
            fill: transparent;
            transition: stroke-dashoffset 0.5s linear;
        }

        /* 控制按钮区域 */
        .controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            font-family: var(--pixel-font);
            padding: 12px 20px;
            font-size: 14px;
            background-color: var(--button);
            color: white;
            border: none;
            border-bottom: 4px solid var(--button-hover);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.1s;
            min-width: 100px;
            text-align: center;
        }

        .btn:hover {
            background-color: var(--button-hover);
            transform: translateY(2px);
            border-bottom-width: 2px;
        }

        .btn:active {
            transform: translateY(4px);
            border-bottom-width: 0;
        }

        .btn.skip {
            background-color: #f39c12;
            border-bottom-color: #e67e22;
        }

        .btn.skip:hover {
            background-color: #e67e22;
        }

        /* 设置面板 */
        .settings-panel {
            width: 100%;
            max-width: 600px;
            background-color: rgba(255, 255, 255, 0.8);
            border: 3px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .dark-theme .settings-panel {
            background-color: rgba(40, 40, 60, 0.8);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
        }

        .settings-title {
            font-size: 16px;
            color: var(--primary);
        }

        .toggle-icon {
            font-size: 20px;
            transition: transform 0.3s;
        }

        .settings-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .setting-label {
            font-size: 12px;
        }

        .setting-input {
            font-family: var(--pixel-font);
            padding: 8px;
            border: 2px solid var(--border);
            border-radius: 5px;
            background-color: var(--bg);
            color: var(--text);
        }

        .setting-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-container input {
            width: 20px;
            height: 20px;
        }

        /* 统计数据 */
        .stats {
            margin-top: 20px;
            font-size: 14px;
            text-align: center;
            color: var(--accent);
        }

        .completed-count {
            font-size: 18px;
            color: var(--primary);
            margin-top: 5px;
        }

        /* 响应式设计 */
        @media (max-width: 600px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .timer-container {
                width: 250px;
                height: 250px;
            }
            
            .time-display {
                font-size: 36px;
            }
            
            .controls {
                gap: 10px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 12px;
                min-width: 80px;
            }
            
            .settings-content {
                grid-template-columns: 1fr;
            }
        }

        /* 动画效果 */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .bounce {
            animation: bounce 1s infinite;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
    <div class="header">
        <h1>番茄钟</h1>
        <div class="theme-selector">
            <div class="theme-btn candy" data-theme="candy"></div>
            <div class="theme-btn mint" data-theme="mint"></div>
            <div class="theme-btn sakura" data-theme="sakura"></div>
            <div class="theme-btn dark" data-theme="dark"></div>
        </div>
    </div>

    <div class="timer-container">
        <svg class="progress-ring" width="300" height="300">
            <circle class="progress-ring-circle" r="140" cx="150" cy="150"></circle>
        </svg>
        <div class="timer-display">
            <div class="phase-label" id="phase-label">工作时间</div>
            <div class="time-display" id="time-display">25:00</div>
        </div>
    </div>

    <div class="controls">
        <button class="btn" id="start-btn">开始</button>
        <button class="btn" id="pause-btn">暂停</button>
        <button class="btn" id="reset-btn">重置</button>
        <button class="btn skip" id="skip-btn">跳过</button>
    </div>

    <div class="settings-panel">
        <div class="settings-header">
            <div class="settings-title">设置</div>
            <div class="toggle-icon">▼</div>
        </div>
        <div class="settings-content">
            <div class="setting-group">
                <label class="setting-label">工作时间 (分钟)</label>
                <input type="number" class="setting-input" id="work-duration" min="1" max="60" value="25">
            </div>
            <div class="setting-group">
                <label class="setting-label">短休息时间 (分钟)</label>
                <input type="number" class="setting-input" id="short-break" min="1" max="30" value="5">
            </div>
            <div class="setting-group">
                <label class="setting-label">长休息时间 (分钟)</label>
                <input type="number" class="setting-input" id="long-break" min="1" max="60" value="15">
            </div>
            <div class="setting-group">
                <label class="setting-label">音效音量</label>
                <input type="range" class="setting-input" id="volume" min="0" max="100" value="50">
            </div>
            <div class="setting-group checkbox-container">
                <input type="checkbox" id="auto-start">
                <label class="setting-label">自动开始下一个时段</label>
            </div>
            <div class="setting-group checkbox-container">
                <input type="checkbox" id="sound-enabled" checked>
                <label class="setting-label">启用音效</label>
            </div>
        </div>
    </div>

    <div class="stats">
        <div>今日完成番茄钟</div>
        <div class="completed-count" id="completed-count">0</div>
    </div>

    <script>
        // 番茄钟应用状态管理
        const appState = {
            // 计时器状态
            isRunning: false,
            isPaused: false,
            currentPhase: 'work', // 'work', 'shortBreak', 'longBreak'
            timeLeft: 25 * 60, // 以秒为单位
            completedPomodoros: 0,
            
            // 设置
            workDuration: 25 * 60, // 工作时间（秒）
            shortBreakDuration: 5 * 60, // 短休息时间（秒）
            longBreakDuration: 15 * 60, // 长休息时间（秒）
            autoStartNext: false,
            soundEnabled: true,
            volume: 0.5,
            
            // 计时器引用
            timer: null,
            
            // DOM元素
            elements: {
                phaseLabel: document.getElementById('phase-label'),
                timeDisplay: document.getElementById('time-display'),
                startBtn: document.getElementById('start-btn'),
                pauseBtn: document.getElementById('pause-btn'),
                resetBtn: document.getElementById('reset-btn'),
                skipBtn: document.getElementById('skip-btn'),
                completedCount: document.getElementById('completed-count'),
                workDurationInput: document.getElementById('work-duration'),
                shortBreakInput: document.getElementById('short-break'),
                longBreakInput: document.getElementById('long-break'),
                volumeInput: document.getElementById('volume'),
                autoStartCheckbox: document.getElementById('auto-start'),
                soundEnabledCheckbox: document.getElementById('sound-enabled'),
                progressCircle: document.querySelector('.progress-ring-circle'),
                themeButtons: document.querySelectorAll('.theme-btn'),
                settingsHeader: document.querySelector('.settings-header'),
                settingsContent: document.querySelector('.settings-content'),
                toggleIcon: document.querySelector('.toggle-icon')
            }
        };

        // 初始化应用
        function initApp() {
            loadSettings();
            updateDisplay();
            setupEventListeners();
            setupKeyboardShortcuts();
            updateProgressRing();
        }

        // 加载用户设置
        function loadSettings() {
            const savedSettings = localStorage.getItem('pomodoroSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                appState.workDuration = settings.workDuration || 25 * 60;
                appState.shortBreakDuration = settings.shortBreakDuration || 5 * 60;
                appState.longBreakDuration = settings.longBreakDuration || 15 * 60;
                appState.autoStartNext = settings.autoStartNext || false;
                appState.soundEnabled = settings.soundEnabled !== undefined ? settings.soundEnabled : true;
                appState.volume = settings.volume || 0.5;
                appState.completedPomodoros = settings.completedPomodoros || 0;
                
                // 应用设置到UI
                appState.elements.workDurationInput.value = appState.workDuration / 60;
                appState.elements.shortBreakInput.value = appState.shortBreakDuration / 60;
                appState.elements.longBreakInput.value = appState.longBreakDuration / 60;
                appState.elements.volumeInput.value = appState.volume * 100;
                appState.elements.autoStartCheckbox.checked = appState.autoStartNext;
                appState.elements.soundEnabledCheckbox.checked = appState.soundEnabled;
                appState.elements.completedCount.textContent = appState.completedPomodoros;
                
                // 设置主题
                if (settings.theme) {
                    setTheme(settings.theme);
                }
            } else {
                // 默认设置
                appState.elements.workDurationInput.value = 25;
                appState.elements.shortBreakInput.value = 5;
                appState.elements.longBreakInput.value = 15;
            }
            
            // 初始化时间为工作时间
            appState.timeLeft = appState.workDuration;
        }

        // 保存用户设置
        function saveSettings() {
            const settings = {
                workDuration: appState.workDuration,
                shortBreakDuration: appState.shortBreakDuration,
                longBreakDuration: appState.longBreakDuration,
                autoStartNext: appState.autoStartNext,
                soundEnabled: appState.soundEnabled,
                volume: appState.volume,
                completedPomodoros: appState.completedPomodoros,
                theme: document.body.dataset.theme || 'candy'
            };
            localStorage.setItem('pomodoroSettings', JSON.stringify(settings));
        }

        // 设置主题
        function setTheme(theme) {
            document.body.dataset.theme = theme;
            document.body.className = theme + '-theme';
            
            // 更新CSS变量
            const root = document.documentElement;
            if (theme === 'candy') {
                root.style.setProperty('--primary', 'var(--candy-primary)');
                root.style.setProperty('--secondary', 'var(--candy-secondary)');
                root.style.setProperty('--accent', 'var(--candy-accent)');
                root.style.setProperty('--bg', 'var(--candy-bg)');
                root.style.setProperty('--text', 'var(--candy-text)');
                root.style.setProperty('--border', 'var(--candy-border)');
                root.style.setProperty('--button', 'var(--candy-button)');
                root.style.setProperty('--button-hover', 'var(--candy-button-hover)');
                root.style.setProperty('--progress', 'var(--candy-progress)');
            } else if (theme === 'mint') {
                root.style.setProperty('--primary', 'var(--mint-primary)');
                root.style.setProperty('--secondary', 'var(--mint-secondary)');
                root.style.setProperty('--accent', 'var(--mint-accent)');
                root.style.setProperty('--bg', 'var(--mint-bg)');
                root.style.setProperty('--text', 'var(--mint-text)');
                root.style.setProperty('--border', 'var(--mint-border)');
                root.style.setProperty('--button', 'var(--mint-button)');
                root.style.setProperty('--button-hover', 'var(--mint-button-hover)');
                root.style.setProperty('--progress', 'var(--mint-progress)');
            } else if (theme === 'sakura') {
                root.style.setProperty('--primary', 'var(--sakura-primary)');
                root.style.setProperty('--secondary', 'var(--sakura-secondary)');
                root.style.setProperty('--accent', 'var(--sakura-accent)');
                root.style.setProperty('--bg', 'var(--sakura-bg)');
                root.style.setProperty('--text', 'var(--sakura-text)');
                root.style.setProperty('--border', 'var(--sakura-border)');
                root.style.setProperty('--button', 'var(--sakura-button)');
                root.style.setProperty('--button-hover', 'var(--sakura-button-hover)');
                root.style.setProperty('--progress', 'var(--sakura-progress)');
            } else if (theme === 'dark') {
                root.style.setProperty('--primary', 'var(--dark-primary)');
                root.style.setProperty('--secondary', 'var(--dark-secondary)');
                root.style.setProperty('--accent', 'var(--dark-accent)');
                root.style.setProperty('--bg', 'var(--dark-bg)');
                root.style.setProperty('--text', 'var(--dark-text)');
                root.style.setProperty('--border', 'var(--dark-border)');
                root.style.setProperty('--button', 'var(--dark-button)');
                root.style.setProperty('--button-hover', 'var(--dark-button-hover)');
                root.style.setProperty('--progress', 'var(--dark-progress)');
            }
            
            saveSettings();
        }

        // 更新显示
        function updateDisplay() {
            // 更新阶段标签
            const phaseLabels = {
                'work': '工作时间',
                'shortBreak': '短休息',
                'longBreak': '长休息'
            };
            appState.elements.phaseLabel.textContent = phaseLabels[appState.currentPhase];
            
            // 更新时间显示
            const minutes = Math.floor(appState.timeLeft / 60);
            const seconds = appState.timeLeft % 60;
            appState.elements.timeDisplay.textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // 更新页面标题
            if (appState.isRunning) {
                document.title = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')} - 番茄钟`;
            } else {
                document.title = '番茄钟';
            }
            
            // 更新进度环
            updateProgressRing();
        }

        // 更新进度环
        function updateProgressRing() {
            const circle = appState.elements.progressCircle;
            const radius = circle.r.baseVal.value;
            const circumference = 2 * Math.PI * radius;
            
            let totalTime;
            switch(appState.currentPhase) {
                case 'work':
                    totalTime = appState.workDuration;
                    break;
                case 'shortBreak':
                    totalTime = appState.shortBreakDuration;
                    break;
                case 'longBreak':
                    totalTime = appState.longBreakDuration;
                    break;
            }
            
            const offset = circumference - (appState.timeLeft / totalTime) * circumference;
            circle.style.strokeDasharray = `${circumference} ${circumference}`;
            circle.style.strokeDashoffset = offset;
        }

        // 开始计时器
        function startTimer() {
            if (appState.isRunning) return;
            
            appState.isRunning = true;
            appState.isPaused = false;
            
            appState.timer = setInterval(() => {
                appState.timeLeft--;
                updateDisplay();
                
                if (appState.timeLeft <= 0) {
                    completePhase();
                }
            }, 1000);
            
            // 播放开始音效
            if (appState.soundEnabled) {
                playSound('start');
            }
        }

        // 暂停计时器
        function pauseTimer() {
            if (!appState.isRunning || appState.isPaused) return;
            
            appState.isPaused = true;
            appState.isRunning = false;
            clearInterval(appState.timer);
        }

        // 重置计时器
        function resetTimer() {
            appState.isRunning = false;
            appState.isPaused = false;
            clearInterval(appState.timer);
            
            // 重置为当前阶段的初始时间
            switch(appState.currentPhase) {
                case 'work':
                    appState.timeLeft = appState.workDuration;
                    break;
                case 'shortBreak':
                    appState.timeLeft = appState.shortBreakDuration;
                    break;
                case 'longBreak':
                    appState.timeLeft = appState.longBreakDuration;
                    break;
            }
            
            updateDisplay();
        }

        // 跳过当前阶段
        function skipPhase() {
            completePhase();
        }

        // 完成当前阶段
        function completePhase() {
            appState.isRunning = false;
            appState.isPaused = false;
            clearInterval(appState.timer);
            
            // 播放完成音效
            if (appState.soundEnabled) {
                playSound('complete');
            }
            
            // 如果是工作阶段，增加完成计数
            if (appState.currentPhase === 'work') {
                appState.completedPomodoros++;
                appState.elements.completedCount.textContent = appState.completedPomodoros;
            }
            
            // 切换到下一个阶段
            switch(appState.currentPhase) {
                case 'work':
                    // 每4个番茄钟后进行长休息
                    if (appState.completedPomodoros % 4 === 0) {
                        appState.currentPhase = 'longBreak';
                        appState.timeLeft = appState.longBreakDuration;
                    } else {
                        appState.currentPhase = 'shortBreak';
                        appState.timeLeft = appState.shortBreakDuration;
                    }
                    break;
                case 'shortBreak':
                case 'longBreak':
                    appState.currentPhase = 'work';
                    appState.timeLeft = appState.workDuration;
                    break;
            }
            
            updateDisplay();
            
            // 如果启用自动开始，开始下一个阶段
            if (appState.autoStartNext) {
                setTimeout(startTimer, 1000);
            }
        }

        // 播放音效
        function playSound(type) {
            // 创建音频上下文
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            const audioCtx = new AudioContext();
            
            // 根据类型生成不同的音效
            let oscillator, gainNode;
            
            gainNode = audioCtx.createGain();
            gainNode.gain.value = appState.volume;
            gainNode.connect(audioCtx.destination);
            
            oscillator = audioCtx.createOscillator();
            oscillator.connect(gainNode);
            
            switch(type) {
                case 'start':
                    oscillator.type = 'square';
                    oscillator.frequency.value = 523.25; // C5
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.2);
                    break;
                case 'complete':
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                    oscillator.frequency.setValueAtTime(659.25, audioCtx.currentTime + 0.1); // E5
                    oscillator.frequency.setValueAtTime(783.99, audioCtx.currentTime + 0.2); // G5
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.3);
                    break;
                case 'tick':
                    oscillator.type = 'triangle';
                    oscillator.frequency.value = 880; // A5
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.05);
                    break;
            }
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 控制按钮
            appState.elements.startBtn.addEventListener('click', startTimer);
            appState.elements.pauseBtn.addEventListener('click', pauseTimer);
            appState.elements.resetBtn.addEventListener('click', resetTimer);
            appState.elements.skipBtn.addEventListener('click', skipPhase);
            
            // 设置输入
            appState.elements.workDurationInput.addEventListener('change', (e) => {
                appState.workDuration = parseInt(e.target.value) * 60;
                if (appState.currentPhase === 'work' && !appState.isRunning) {
                    appState.timeLeft = appState.workDuration;
                    updateDisplay();
                }
                saveSettings();
            });
            
            appState.elements.shortBreakInput.addEventListener('change', (e) => {
                appState.shortBreakDuration = parseInt(e.target.value) * 60;
                if (appState.currentPhase === 'shortBreak' && !appState.isRunning) {
                    appState.timeLeft = appState.shortBreakDuration;
                    updateDisplay();
                }
                saveSettings();
            });
            
            appState.elements.longBreakInput.addEventListener('change', (e) => {
                appState.longBreakDuration = parseInt(e.target.value) * 60;
                if (appState.currentPhase === 'longBreak' && !appState.isRunning) {
                    appState.timeLeft = appState.longBreakDuration;
                    updateDisplay();
                }
                saveSettings();
            });
            
            appState.elements.volumeInput.addEventListener('input', (e) => {
                appState.volume = e.target.value / 100;
                saveSettings();
            });
            
            appState.elements.autoStartCheckbox.addEventListener('change', (e) => {
                appState.autoStartNext = e.target.checked;
                saveSettings();
            });
            
            appState.elements.soundEnabledCheckbox.addEventListener('change', (e) => {
                appState.soundEnabled = e.target.checked;
                saveSettings();
            });
            
            // 主题按钮
            appState.elements.themeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    setTheme(btn.dataset.theme);
                });
            });
            
            // 设置面板切换
            appState.elements.settingsHeader.addEventListener('click', () => {
                const isVisible = appState.elements.settingsContent.style.display !== 'none';
                appState.elements.settingsContent.style.display = isVisible ? 'none' : 'grid';
                appState.elements.toggleIcon.textContent = isVisible ? '▼' : '▲';
            });
        }

        // 设置键盘快捷键
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // 防止在输入框中触发快捷键
                if (e.target.tagName === 'INPUT') return;
                
                switch(e.key) {
                    case ' ':
                        e.preventDefault();
                        if (appState.isRunning) {
                            pauseTimer();
                        } else {
                            startTimer();
                        }
                        break;
                    case 'r':
                    case 'R':
                        resetTimer();
                        break;
                    case 's':
                    case 'S':
                        skipPhase();
                        break;
                }
            });
        }

        // 初始化应用
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>